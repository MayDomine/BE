g43: ----------------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
g43:                                                                                                 Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
g43: ----------------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
g43: void flash_bwd_dq_dk_dv_loop_seqk_parallel_kernel<Flash_bwd_kernel_traits<128, 64, 128, 8, 2, 4, ...         0.00%       0.000us         0.00%       0.000us       0.000us       13.804s        53.31%       13.804s      37.108ms           372  
g43:                                             ncclDevKernel_SendRecv(ncclDevKernelArgsStorage<4096ul>)         0.00%       0.000us         0.00%       0.000us       0.000us        5.708s        22.04%        5.708s       5.078ms          1124  
g43: void flash_fwd_kernel<Flash_fwd_kernel_traits<128, 128, 64, 4, false, false, cutlass::half_t, Fla...         0.00%       0.000us         0.00%       0.000us       0.000us        4.901s        18.93%        4.901s      13.728ms           357  
g43: void flash_bwd_dq_dk_dv_loop_seqk_parallel_kernel<Flash_bwd_kernel_traits<128, 64, 128, 8, 2, 4, ...         0.00%       0.000us         0.00%       0.000us       0.000us     461.377ms         1.78%     461.377ms      38.448ms            12  
g43: void at::native::vectorized_elementwise_kernel<4, at::native::CUDAFunctor_add<c10::Half>, at::det...         0.00%       0.000us         0.00%       0.000us       0.000us     246.658ms         0.95%     246.658ms     201.518us          1224  
g43: void flash_bwd_clear_dqaccum_kernel<Flash_bwd_kernel_traits<128, 64, 128, 8, 2, 4, 2, false, fals...         0.00%       0.000us         0.00%       0.000us       0.000us     223.462ms         0.86%     223.462ms     581.931us           384  
g43: void flash_fwd_kernel<Flash_fwd_kernel_traits<128, 128, 64, 4, false, false, cutlass::half_t, Fla...         0.00%       0.000us         0.00%       0.000us       0.000us     155.226ms         0.60%     155.226ms      14.111ms            11  
g43:                                                                       Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     120.477ms         0.47%     120.477ms     121.326us           993  
g43: void flash_bwd_convert_dq_kernel<Flash_bwd_kernel_traits<128, 64, 128, 8, 2, 4, 2, false, false, ...         0.00%       0.000us         0.00%       0.000us       0.000us     117.972ms         0.46%     117.972ms     307.220us           384  
g43:                                                                     fused_to_sub_sigmoid_sub_mul_sub         0.00%       0.000us         0.00%       0.000us       0.000us     115.514ms         0.45%     115.514ms     323.570us           357  
g43: void at::native::vectorized_elementwise_kernel<4, at::native::FillFunctor<c10::Half>, at::detail:...         0.00%       0.000us         0.00%       0.000us       0.000us      12.846ms         0.05%      12.846ms     136.665us            94  
g43: void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIterat...         0.00%       0.000us         0.00%       0.000us       0.000us      10.151ms         0.04%      10.151ms     441.355us            23  
g43: void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIterat...         0.00%       0.000us         0.00%       0.000us       0.000us       5.204ms         0.02%       5.204ms     433.680us            12  
g43: void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<c10::Half, c10::Half,...         0.00%       0.000us         0.00%       0.000us       0.000us       3.477ms         0.01%       3.477ms     289.765us            12  
g43: void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<flo...         0.00%       0.000us         0.00%       0.000us       0.000us       3.191ms         0.01%       3.191ms     265.917us            12  
g43: void at::native::vectorized_elementwise_kernel<4, at::native::CUDAFunctor_add<float>, at::detail:...         0.00%       0.000us         0.00%       0.000us       0.000us       3.122ms         0.01%       3.122ms       4.372us           714  
g43: void at::native::elementwise_kernel<128, 2, at::native::gpu_kernel_impl_nocast<at::native::direct...         0.00%       0.000us         0.00%       0.000us       0.000us       3.083ms         0.01%       3.083ms       7.865us           392  
g43: void at::native::vectorized_elementwise_kernel<4, at::native::launch_log_sigmoid_forward_kernel(a...         0.00%       0.000us         0.00%       0.000us       0.000us       1.481ms         0.01%       1.481ms       4.148us           357  
g43:                                                                                       cudaEventQuery         0.29%      57.227ms         0.29%      57.635ms       1.235us       0.000us         0.00%       0.000us       0.000us         46685  
g43:                                                                                      cudaMemcpyAsync        12.63%        2.535s        12.65%        2.540s       2.954ms       0.000us         0.00%       0.000us       0.000us           860  
g43:                                                                                     cudaLaunchKernel        47.69%        9.575s        47.75%        9.587s       2.591ms       0.000us         0.00%       0.000us       0.000us          3700  
g43:                                                                                      cudaEventRecord         0.09%      17.710ms         0.09%      18.213ms       2.350us       0.000us         0.00%       0.000us       0.000us          7750  
g43:                                                                                  cudaStreamWaitEvent         0.03%       6.682ms         0.03%       6.701ms       0.927us       0.000us         0.00%       0.000us       0.000us          7230  
g43:                                                                          cudaStreamGetCaptureInfo_v2         0.00%     820.637us         0.00%     820.637us       0.864us       0.000us         0.00%       0.000us       0.000us           950  
g43:                                                                                cudaStreamIsCapturing         0.01%       2.835ms         0.01%       2.835ms       0.532us       0.000us         0.00%       0.000us       0.000us          5330  
g43:                                                                                  cudaGetFuncBySymbol         0.00%     356.330us         0.00%     356.330us       0.375us       0.000us         0.00%       0.000us       0.000us           950  
g43:                                                                                     cuLaunchKernelEx        17.65%        3.544s        17.67%        3.547s       3.733ms       0.000us         0.00%       0.000us       0.000us           950  
g43:                                                                                 cudaFuncSetAttribute         0.00%     946.324us         0.00%     952.920us       1.489us       0.000us         0.00%       0.000us       0.000us           640  
g43:                                                                                       cuLaunchKernel         5.62%        1.128s         5.62%        1.129s       3.643ms       0.000us         0.00%       0.000us       0.000us           310  
g43:                                                                               cudaDeviceGetAttribute         0.00%     248.141us         0.00%     248.141us       0.775us       0.000us         0.00%       0.000us       0.000us           320  
g43:                                                                                cudaDeviceSynchronize        15.97%        3.207s        16.00%        3.211s        3.211s       0.000us         0.00%       0.000us       0.000us             1  
g43: ----------------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
g43: Self CPU time total: 20.076s
g43: Self CUDA time total: 25.896s
g43: 
g43: burst
g43: 	  batch_size   |     seqlen     |   num_heads    |      dim       |     causal     |  double_ring   |    opt_bwd     
g43: 	      1        |     524288     |       40       |      128       |      True      |      True      |      True      
g43: 	Time: | forward: 465.33 s | forward_backward: 1715.70 ms
g43: 	TFLOPS| | forward: 189.03 TFLOPS | forward_backward: 179.44 TFLOPS | backward: 175.93 TFLOPS
